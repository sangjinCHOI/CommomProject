<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper
	namespace="com.ssafy.persona.character.mapper.CharacterMapper">

	<insert id="regist">
		insert into tb_character
			(user_seq, category_seq, nickname, introduction, character_created_date)
		values
			(#{userSeq}, #{categorySeq}, #{nickname}, #{introduction}, now())
	</insert>

	<update id="update">
		update tb_character set
		<if test="nickname != null and nickname != ''">
			nickname=#{nickname},
		</if>
		<if test="introduction != null and introduction != ''">
			introduction=#{introduction},
		</if>
		<if
			test="representativeAchievement != null and representativeAchievement != ''">
			representative_achievement=#{representativeAchievement},
		</if>
		<if test="characterActive != null and characterActive != ''">
			character_active=#{characterActive},
		</if>
		<if
			test="characterDeleteReason != null and characterDeleteReason != ''">
			character_delete_reason=#{characterDeleteReason},
		</if>
		character_modified_date = now()
		where character_seq=#{characterSeq}
	</update>

	<update id="delete">
		update tb_character set
			character_active=0,
			character_delete_reason=#{characterDeleteReason},
			character_modified_date = now()
		where character_seq=#{characterSeq}
	</update>

	<select id="detail"	resultType="com.ssafy.persona.character.model.dto.CharacterGetResponse">
		select 
			nickname as nickname, category_seq as categorySeq, introduction as introduction, representative_achievement as representativeAchievement,
			 alarm_allow as alarmAllow,
			like_alarm as likeAlarm, reply_alarm as replyAlarm, follow_alarm as followAlarm, modify_alarm as modifyAlarm,
			 reported_time as reportedTime, character_active as characterActive
			, character_created_date as characterCreatedDate, character_modified_date as characterModifiedDate
		from
			tb_character
		where character_seq=#{characterSeq}
	</select>

	<select id="list"
		resultType="com.ssafy.persona.character.model.dto.CharacterGetResponse">
		select 
			nickname, category_seq, introduction, representative_achievement, alarm_allow,
			like_alarm, reply_alarm, follow_alarm, modify_alarm, reported_time, character_active
			, character_created_date, character_modified_date
		from
			tb_character
		where user_seq= #{userSeq}
	</select>



</mapper>